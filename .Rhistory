knitr::opts_chunk$set(echo = TRUE)
data<- read.csv("https://github.com/christinafu/qtm302w/adult24.csv")
data<- read.csv("https://github.com/christinafu/qtm302w/adult24.csv")
knitr::opts_chunk$set(echo = TRUE)
data<- read.csv("https://github.com/christinafu/qtm302w/adult24.csv")
data<- read.csv("https://github.com/christinafu/qtm302w/adult24.csv")
data<- read.csv("https://raw.githubusercontent.com/christinafu/qtm302w/main/adult24.csv")
data<- read.csv("https://raw.githubusercontent.com/christinafu/qtm302w/main/adult24.csv")
data<- read.csv("./adult24.csv")
knitr::opts_chunk$set(echo = TRUE)
data<- read.csv("./adult24.csv")
vars <- c(
"ANXEV_A","DEPEV_A",
"MHRX_A","MHTHRPY_A","MHTPYNOW_A","MHTHDLY_A","MHTHND_A",
"SAD_A","NERVOUS_A","RESTLESS_A","HOPELESS_A","EFFORT_A","WORTHLESS_A",
"CFSEV_A","CFSNOW_A",
"SLPHOURS_A","SLPREST_A","SLPFLL_A","SLPSTY_A","SLPMED1_A","SLPMED2_A","SLPMED3_A"
)
id_like <- c("SEQN","RespondentID","ID")
vars <- unique(c(intersect(id_like, names(data)), vars))
keep <- intersect(vars, names(data))
out  <- data[ , keep, drop = FALSE]
out_path <- "./adult24_selected.csv"
write.csv(out, out_path, row.names = FALSE)
cat("Saved:", out_path, "\nColumns:", paste(colnames(out), collapse=", "), "\n")
data_selected<- read.csv("./adult24_selected.csv")
library(dplyr)
library(stringr)
# --- 1) Rename to friendlier snake_case (only if columns exist) ---
data_selected <- data_selected %>%
rename(
anxiety_ever       = "ANXEV_A",
depression_ever       = "DEPEV_A",
medication_past12     = "MHRX_A",
therapy_past12 = "MHTHRPY_A",
therapy_now = "MHTPYNOW_A",
delay_therapy  = "MHTHDLY_A",
need_therapy = "MHTHND_A",
sad_30d        = "SAD_A",
nervous_30d    = "NERVOUS_A",
restless_30d   = "RESTLESS_A",
hopeless_30d   = "HOPELESS_A",
effort_30d     = "EFFORT_A",
worthless_30d  = "WORTHLESS_A",
cfs_ever       ="CFSEV_A",
cfs_now        = "CFSNOW_A",
sleep_hours    = "SLPHOURS_A",
well_rested    = "SLPREST_A",
trouble_fall_asleep    = "SLPFLL_A",
trouble_stay_asleep     ="SLPSTY_A",
prescribe_med_sleep = "SLPMED1_A",
otc_med_sleep  = "SLPMED2_A",
mj_sleep   = "SLPMED3_A"
)
if ("sleep_hours" %in% names(data_selected)) {
data_selected <- data_selected %>%
mutate(sleep_hours = ifelse(sleep_hours >= 0 & sleep_hours <= 24, sleep_hours, NA_real_))
}
library(ggplot2)
# Summary Statistics
summary(data_selected$sleep_hours)
# Histogram
ggplot(data_selected, aes(x = sleep_hours)) +
geom_histogram(binwidth = 0.5) +
scale_x_continuous(breaks = seq(0, 24, by = 1)) +
labs(x = "Hours of sleep per day", y = "Count",
title = "Distribution of reported sleep duration") +
theme_minimal()
# Therapy/Counseling Received
ggplot(data_selected, aes(x = factor(therapy_past12))) +
geom_bar() +
labs(x = "Received counseling/therapy within past 12 months", y = "Count",
title = "Therapy usage among respondents")
# Restlessness (indicator of psychological distress)
ggplot(data_selected, aes(x = factor(restless_30d), y = sleep_hours)) +
geom_boxplot() +
labs(x = "Restlessness level", y = "Hours of sleep",
title = "Sleep duration vs. restlessness")
spearman_result <-cor.test(data_selected$sleep_hours, data_selected$restless_30d,  method = "spearman")
spearman_result
ggplot(data_selected, aes(x = sleep_hours, y = restless_30d)) +
geom_point(alpha = 0.4) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
title = "Relationship between sleep duration and restlessness",
x = "Restlessness level",
y = "Sleep duration (hours)"
) +
theme_minimal()
# Creating a variable that combines depression & anxiety variables
data_selected <- data_selected %>%
mutate(
depression_ever = ifelse(depression_ever %in% c(7, 8, 9), NA, depression_ever),
anxiety_ever = ifelse(anxiety_ever %in% c(7, 8, 9), NA, anxiety_ever),
mh_group = case_when(
depression_ever == 1 & anxiety_ever == 1 ~ "Both depression and anxiety",
depression_ever == 1 & anxiety_ever == 2 ~ "Depression only",
depression_ever == 2 & anxiety_ever == 1 ~ "Anxiety only",
depression_ever == 2 & anxiety_ever == 2 ~ "Neither",
TRUE ~ NA_character_
)
)
table(data_selected$mh_group)
# Visualization
data_selected %>%
group_by(mh_group) %>%
summarise(avg_sleep = mean(sleep_hours, na.rm = TRUE), sd_sleep = sd(sleep_hours, na.rm = TRUE), n = n()) %>%
ggplot(aes(x = mh_group, y = avg_sleep, ymin = avg_sleep - sd_sleep, ymax = avg_sleep + sd_sleep)) +
geom_col(fill = "lightblue") +
geom_errorbar(width = 0.2) +
labs(x = "Mental health disorder", y = "Mean hours of sleep",
title = "Average sleep by prevalence of anxiety and depression") +
theme_minimal()
# ANOVA test to determine if there is a significant difference in means
anova_result <- aov(sleep_hours ~ mh_group, data = data_selected)
summary(anova_result)
# p-value = 8.21e-07 which suggests a significant difference in means across groups
knitr::opts_chunk$set(echo = TRUE)
data<- read.csv("./adult24.csv")
vars <- c(
"ANXEV_A","DEPEV_A",
"MHRX_A","MHTHRPY_A","MHTPYNOW_A","MHTHDLY_A","MHTHND_A",
"SAD_A","NERVOUS_A","RESTLESS_A","HOPELESS_A","EFFORT_A","WORTHLESS_A",
"CFSEV_A","CFSNOW_A",
"SLPHOURS_A","SLPREST_A","SLPFLL_A","SLPSTY_A","SLPMED1_A","SLPMED2_A","SLPMED3_A"
)
id_like <- c("SEQN","RespondentID","ID")
vars <- unique(c(intersect(id_like, names(data)), vars))
keep <- intersect(vars, names(data))
out  <- data[ , keep, drop = FALSE]
out_path <- "./adult24_selected.csv"
write.csv(out, out_path, row.names = FALSE)
cat("Saved:", out_path, "\nColumns:", paste(colnames(out), collapse=", "), "\n")
data_selected<- read.csv("./adult24_selected.csv")
library(dplyr)
library(stringr)
# --- 1) Rename to friendlier snake_case (only if columns exist) ---
data_selected <- data_selected %>%
rename(
anxiety_ever       = "ANXEV_A",
depression_ever       = "DEPEV_A",
medication_past12     = "MHRX_A",
therapy_past12 = "MHTHRPY_A",
therapy_now = "MHTPYNOW_A",
delay_therapy  = "MHTHDLY_A",
need_therapy = "MHTHND_A",
sad_30d        = "SAD_A",
nervous_30d    = "NERVOUS_A",
restless_30d   = "RESTLESS_A",
hopeless_30d   = "HOPELESS_A",
effort_30d     = "EFFORT_A",
worthless_30d  = "WORTHLESS_A",
cfs_ever       ="CFSEV_A",
cfs_now        = "CFSNOW_A",
sleep_hours    = "SLPHOURS_A",
well_rested    = "SLPREST_A",
trouble_fall_asleep    = "SLPFLL_A",
trouble_stay_asleep     ="SLPSTY_A",
prescribe_med_sleep = "SLPMED1_A",
otc_med_sleep  = "SLPMED2_A",
mj_sleep   = "SLPMED3_A"
)
if ("sleep_hours" %in% names(data_selected)) {
data_selected <- data_selected %>%
mutate(sleep_hours = ifelse(sleep_hours >= 0 & sleep_hours <= 24, sleep_hours, NA_real_))
}
library(ggplot2)
# Summary Statistics
summary(data_selected$sleep_hours)
# Histogram
ggplot(data_selected, aes(x = sleep_hours)) +
geom_histogram(binwidth = 0.5) +
scale_x_continuous(breaks = seq(0, 24, by = 1)) +
labs(x = "Hours of sleep per day", y = "Count",
title = "Distribution of reported sleep duration") +
theme_minimal()
# Therapy/Counseling Received
ggplot(data_selected, aes(x = factor(therapy_past12))) +
geom_bar() +
labs(x = "Received counseling/therapy within past 12 months", y = "Count",
title = "Therapy usage among respondents") +
theme_minimal()
# Restlessness (indicator of psychological distress)
ggplot(data_selected, aes(x = factor(restless_30d), y = sleep_hours)) +
geom_boxplot() +
labs(x = "Restlessness level", y = "Hours of sleep",
title = "Sleep duration vs. restlessness") +
theme_minimal()
spearman_result <-cor.test(data_selected$sleep_hours, data_selected$restless_30d,  method = "spearman")
spearman_result
ggplot(data_selected, aes(x = sleep_hours, y = restless_30d)) +
geom_point(alpha = 0.4) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
title = "Relationship between sleep duration and restlessness",
x = "Restlessness level",
y = "Sleep duration (hours)"
) +
theme_minimal()
# Creating a variable that combines depression & anxiety variables
data_selected <- data_selected %>%
mutate(
depression_ever = ifelse(depression_ever %in% c(7, 8, 9), NA, depression_ever),
anxiety_ever = ifelse(anxiety_ever %in% c(7, 8, 9), NA, anxiety_ever),
mh_group = case_when(
depression_ever == 1 & anxiety_ever == 1 ~ "Both depression and anxiety",
depression_ever == 1 & anxiety_ever == 2 ~ "Depression only",
depression_ever == 2 & anxiety_ever == 1 ~ "Anxiety only",
depression_ever == 2 & anxiety_ever == 2 ~ "Neither",
TRUE ~ NA_character_
)
)
table(data_selected$mh_group)
# Visualization
data_selected %>%
group_by(mh_group) %>%
summarise(avg_sleep = mean(sleep_hours, na.rm = TRUE), sd_sleep = sd(sleep_hours, na.rm = TRUE), n = n()) %>%
ggplot(aes(x = mh_group, y = avg_sleep, ymin = avg_sleep - sd_sleep, ymax = avg_sleep + sd_sleep)) +
geom_col(fill = "lightblue") +
geom_errorbar(width = 0.2) +
labs(x = "Mental health disorder", y = "Mean hours of sleep",
title = "Average sleep by prevalence of anxiety and depression") +
theme_minimal()
# ANOVA test to determine if there is a significant difference in means
anova_result <- aov(sleep_hours ~ mh_group, data = data_selected)
summary(anova_result)
# p-value = 8.21e-07 which suggests a significant difference in means across groups
